<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxury Casino Blackjack</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #D4AF37;
            --gold-dark: #B38B2D;
            --red: #C00;
            --black: #111;
            --green: #0A5C36;
            --green-dark: #07422A;
            --light: #F8F8F8;
            --dark: #222;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--black);
            color: var(--light);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url('https://images.unsplash.com/photo-1596838132731-3301c3fd4317?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            background-color: rgba(10, 10, 10, 0.9);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
            border: 2px solid var(--gold);
        }
        
        .screen {
            display: none;
            padding: 30px;
        }
        
        .active {
            display: block;
        }
        
        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
            color: var(--gold);
            text-align: center;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        h2 {
            font-size: 2rem;
            margin-bottom: 20px;
        }
        
        h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
        }
        
        /* Login/Signup Styles */
        .auth-form {
            max-width: 500px;
            margin: 0 auto;
            background-color: rgba(30, 30, 30, 0.8);
            padding: 30px;
            border-radius: 8px;
            border: 1px solid var(--gold);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--gold);
        }
        
        input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #444;
            border-radius: 6px;
            background-color: rgba(50, 50, 50, 0.8);
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus {
            outline: none;
            border-color: var(--gold);
            background-color: rgba(70, 70, 70, 0.8);
        }
        
        .btn {
            background-color: var(--gold);
            color: var(--black);
            border: none;
            padding: 14px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Montserrat', sans-serif;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        .btn:hover {
            background-color: var(--gold-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.4);
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }
        
        .btn-danger {
            background-color: var(--red);
            color: white;
        }
        
        .btn-secondary {
            background-color: #444;
            color: white;
        }
        
        .link {
            color: var(--gold);
            text-decoration: none;
            cursor: pointer;
            transition: color 0.3s;
            font-weight: 600;
        }
        
        .link:hover {
            color: var(--gold-dark);
            text-decoration: underline;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mt-20 {
            margin-top: 20px;
        }
        
        /* Menu Screen */
        .user-info {
            background-color: rgba(0, 0, 0, 0.7);
            padding: 15px 20px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            border: 1px solid var(--gold);
        }
        
        .user-info span {
            font-weight: 600;
        }
        
        .user-balance {
            color: var(--gold);
            font-size: 1.1rem;
        }
        
        .tables {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .table-card {
            background-color: rgba(30, 30, 30, 0.8);
            border-radius: 8px;
            padding: 25px;
            border: 1px solid var(--gold);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .table-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .table-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background-color: var(--gold);
        }
        
        .table-requirements {
            margin: 15px 0;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
            border-left: 3px solid var(--gold);
        }
        
        .table-requirements p {
            margin: 5px 0;
            font-size: 0.9rem;
        }
        
        /* Game Screen */
        .game-area {
            background-color: var(--green);
            border-radius: 10px;
            padding: 25px;
            margin-top: 25px;
            position: relative;
            box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--gold);
        }
        
        .hand {
            min-height: 180px;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .player-area, .dealer-area {
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .player-area {
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        .dealer-area {
            background-color: rgba(0, 0, 0, 0.3);
        }
        
        /* Card Styles */
        .card {
            width: 100px;
            height: 150px;
            background-color: white;
            border-radius: 8px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            position: relative;
            box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.3);
            font-weight: bold;
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card.red {
            color: var(--red);
        }
        
        .card.black {
            color: var(--black);
        }
        
        .card-back {
            background: repeating-linear-gradient(
                45deg,
                #d10000,
                #d10000 10px,
                #8b0000 10px,
                #8b0000 20px
            );
            color: white;
        }
        
        .card-value {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 1.2rem;
        }
        
        .card-suit {
            font-size: 3rem;
        }
        
        /* Chip Styles */
        .chips-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        .chip {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            border: 3px solid;
            font-size: 0.9rem;
        }
        
        .chip:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
        }
        
        .chip-5 {
            background-color: #3498db;
            border-color: #2980b9;
        }
        
        .chip-10 {
            background-color: #2ecc71;
            border-color: #27ae60;
        }
        
        .chip-25 {
            background-color: #9b59b6;
            border-color: #8e44ad;
        }
        
        .chip-50 {
            background-color: #e74c3c;
            border-color: #c0392b;
        }
        
        .chip-100 {
            background-color: #f1c40f;
            border-color: #f39c12;
            color: var(--black);
        }
        
        /* Message area */
        .message {
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            min-height: 40px;
            color: var(--gold);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        /* Current bet display */
        .current-bet {
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 30px;
            display: inline-flex;
            align-items: center;
            border: 2px solid var(--gold);
            margin: 10px 0;
        }
        
        .current-bet span {
            font-weight: bold;
            color: var(--gold);
            font-size: 1.2rem;
            margin-left: 5px;
        }
        
        /* Table limits indicator */
        .table-limits {
            background-color: rgba(0, 0, 0, 0.5);
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            margin: 10px 0;
            border-left: 3px solid var(--gold);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                border-radius: 0;
                min-height: 100vh;
            }
            
            .card {
                width: 70px;
                height: 105px;
            }
            
            .card-suit {
                font-size: 2rem;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .controls .btn {
                width: 100%;
                max-width: 250px;
            }
            
            .tables {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div id="login-screen" class="screen active">
            <h1>Luxury Casino Blackjack</h1>
            <div id="login-form" class="auth-form">
                <h2>Member Login</h2>
                <div class="form-group">
                    <label for="username">Player ID</label>
                    <input type="text" id="username" placeholder="Enter your player ID">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter your password">
                </div>
                <button id="login-btn" class="btn btn-block">Enter Casino</button>
                <p class="text-center mt-20">Not a member? <a class="link" id="show-signup">Join Now</a></p>
            </div>
            <div id="signup-form" class="auth-form" style="display:none">
                <h2>Create Player Account</h2>
                <div class="form-group">
                    <label for="new-username">Player ID</label>
                    <input type="text" id="new-username" placeholder="Choose your player ID">
                </div>
                <div class="form-group">
                    <label for="new-password">Password</label>
                    <input type="password" id="new-password" placeholder="Create password">
                </div>
                <div class="form-group">
                    <label for="confirm-password">Confirm Password</label>
                    <input type="password" id="confirm-password" placeholder="Confirm your password">
                </div>
                <button id="signup-btn" class="btn btn-block">Create Account</button>
                <p class="text-center mt-20">Already a member? <a class="link" id="show-login">Login Here</a></p>
            </div>
        </div>

        <!-- Menu Screen -->
        <div id="menu-screen" class="screen">
            <h1>Select Your Table</h1>
            <div class="user-info">
                <div>
                    Player: <span id="display-username"></span> | 
                    Balance: <span class="user-balance" id="balance">$1,000</span>
                </div>
                <button id="logout-btn" class="btn btn-danger">Cash Out</button>
            </div>
            
            <div class="tables">
                <div class="table-card">
                    <h3>Bronze Table</h3>
                    <div class="table-requirements">
                        <p>• Minimum Buy-in: $100</p>
                        <p>• Minimum Bet: $5</p>
                        <p>• Maximum Bet: $100</p>
                    </div>
                    <p>Perfect for beginners and casual players</p>
                    <button class="btn btn-block stake-btn" data-stake="bronze">Join Table</button>
                </div>
                
                <div class="table-card">
                    <h3>Silver Table</h3>
                    <div class="table-requirements">
                        <p>• Minimum Buy-in: $500</p>
                        <p>• Minimum Bet: $25</p>
                        <p>• Maximum Bet: $500</p>
                    </div>
                    <p>For experienced players</p>
                    <button class="btn btn-block stake-btn" data-stake="silver">Join Table</button>
                </div>
                
                <div class="table-card">
                    <h3>Gold Table</h3>
                    <div class="table-requirements">
                        <p>• Minimum Buy-in: $2,500</p>
                        <p>• Minimum Bet: $100</p>
                        <p>• Maximum Bet: $2,500</p>
                    </div>
                    <p>High stakes action</p>
                    <button class="btn btn-block stake-btn" data-stake="gold">Join Table</button>
                </div>
                
                <div class="table-card">
                    <h3>VIP Table</h3>
                    <div class="table-requirements">
                        <p>• Minimum Buy-in: $10,000</p>
                        <p>• Minimum Bet: $500</p>
                        <p>• Maximum Bet: $10,000</p>
                    </div>
                    <p>Exclusive high roller table</p>
                    <button class="btn btn-block stake-btn" data-stake="vip">Join Table</button>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <h1 id="table-title">Blackjack</h1>
            <div class="user-info">
                <div>
                    Player: <span id="game-username"></span> | 
                    Balance: <span class="user-balance" id="game-balance">$1,000</span> | 
                    Table: <span id="table-type">Bronze</span>
                </div>
                <button id="game-logout-btn" class="btn btn-secondary">Leave Table</button>
            </div>
            
            <div class="game-area">
                <div class="dealer-area">
                    <h3>Dealer</h3>
                    <div id="dealer-hand" class="hand"></div>
                </div>
                
                <div class="player-area">
                    <h3>Player</h3>
                    <div id="player-hand" class="hand"></div>
                </div>
                
                <div class="message" id="message"></div>
                
                <div class="text-center">
                    <div class="table-limits">
                        Table Limits: <span id="min-bet">$5</span> - <span id="max-bet">$100</span>
                    </div>
                    <div class="current-bet">
                        Current Bet: <span id="current-bet">0</span>
                    </div>
                </div>
                
                <div id="betting-controls">
                    <h3>Place Your Bet</h3>
                    <div class="chips-container" id="chips">
                        <div class="chip chip-5" data-amount="5">5</div>
                        <div class="chip chip-10" data-amount="10">10</div>
                        <div class="chip chip-25" data-amount="25">25</div>
                        <div class="chip chip-50" data-amount="50">50</div>
                        <div class="chip chip-100" data-amount="100">100</div>
                    </div>
                    <div class="controls">
                        <button id="clear-bet" class="btn btn-secondary">Clear</button>
                        <button id="deal-btn" class="btn btn-success">Deal Cards</button>
                    </div>
                </div>
                
                <div id="game-controls" style="display:none">
                    <div class="controls">
                        <button id="hit-btn" class="btn">Hit</button>
                        <button id="stand-btn" class="btn btn-danger">Stand</button>
                        <button id="double-btn" class="btn">Double</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state
        const game = {
            user: null,
            users: JSON.parse(localStorage.getItem('blackjackUsers')) || [],
            table: null,
            tableSettings: {
                bronze: { minBuyIn: 100, minBet: 5, maxBet: 100, chipValues: [5, 10, 25, 50, 100] },
                silver: { minBuyIn: 500, minBet: 25, maxBet: 500, chipValues: [25, 50, 100, 250, 500] },
                gold: { minBuyIn: 2500, minBet: 100, maxBet: 2500, chipValues: [100, 250, 500, 1000, 2500] },
                vip: { minBuyIn: 10000, minBet: 500, maxBet: 10000, chipValues: [500, 1000, 2500, 5000, 10000] }
            },
            deck: [],
            dealerHand: [],
            playerHand: [],
            bet: 0,
            balance: 1000,
            gameActive: false
        };

        // DOM elements
        const screens = {
            login: document.getElementById('login-screen'),
            menu: document.getElementById('menu-screen'),
            game: document.getElementById('game-screen')
        };

        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');
        const showSignup = document.getElementById('show-signup');
        const showLogin = document.getElementById('show-login');
        const loginBtn = document.getElementById('login-btn');
        const signupBtn = document.getElementById('signup-btn');
        const stakeBtns = document.querySelectorAll('.stake-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const gameLogoutBtn = document.getElementById('game-logout-btn');
        const usernameDisplay = document.getElementById('display-username');
        const balanceDisplay = document.getElementById('balance');
        const gameUsernameDisplay = document.getElementById('game-username');
        const gameBalanceDisplay = document.getElementById('game-balance');
        const currentBetDisplay = document.getElementById('current-bet');
        const dealerHandDisplay = document.getElementById('dealer-hand');
        const playerHandDisplay = document.getElementById('player-hand');
        const messageDisplay = document.getElementById('message');
        const chips = document.querySelectorAll('.chip');
        const clearBetBtn = document.getElementById('clear-bet');
        const dealBtn = document.getElementById('deal-btn');
        const hitBtn = document.getElementById('hit-btn');
        const standBtn = document.getElementById('stand-btn');
        const doubleBtn = document.getElementById('double-btn');
        const bettingControls = document.getElementById('betting-controls');
        const gameControls = document.getElementById('game-controls');
        const tableTitle = document.getElementById('table-title');
        const tableTypeDisplay = document.getElementById('table-type');
        const minBetDisplay = document.getElementById('min-bet');
        const maxBetDisplay = document.getElementById('max-bet');

        // Event listeners
        showSignup.addEventListener('click', () => {
            loginForm.style.display = 'none';
            signupForm.style.display = 'block';
        });

        showLogin.addEventListener('click', () => {
            signupForm.style.display = 'none';
            loginForm.style.display = 'block';
        });

        loginBtn.addEventListener('click', login);
        signupBtn.addEventListener('click', signup);
        logoutBtn.addEventListener('click', logout);
        gameLogoutBtn.addEventListener('click', leaveGame);

        stakeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const tableType = btn.dataset.stake;
                joinTable(tableType);
            });
        });

        chips.forEach(chip => {
            chip.addEventListener('click', () => {
                const amount = parseInt(chip.dataset.amount);
                placeBet(amount);
            });
        });

        clearBetBtn.addEventListener('click', clearBet);
        dealBtn.addEventListener('click', deal);
        hitBtn.addEventListener('click', hit);
        standBtn.addEventListener('click', stand);
        doubleBtn.addEventListener('click', double);

        // Functions
        function showScreen(screen) {
            Object.values(screens).forEach(s => s.classList.remove('active'));
            screens[screen].classList.add('active');
        }

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const user = game.users.find(u => u.username === username && u.password === password);
            
            if (user) {
                game.user = user;
                game.balance = user.balance;
                updateUserDisplay();
                showScreen('menu');
            } else {
                showMessage('Invalid username or password');
            }
        }

        function signup() {
            const username = document.getElementById('new-username').value;
            const password = document.getElementById('new-password').value;
            const confirm = document.getElementById('confirm-password').value;
            
            if (password !== confirm) {
                showMessage("Passwords don't match");
                return;
            }
            
            if (game.users.some(u => u.username === username)) {
                showMessage("Username already exists");
                return;
            }
            
            const newUser = { username, password, balance: 1000 };
            game.users.push(newUser);
            localStorage.setItem('blackjackUsers', JSON.stringify(game.users));
            
            game.user = newUser;
            game.balance = 1000;
            updateUserDisplay();
            showScreen('menu');
            
            // Switch back to login form and clear inputs
            showLogin.click();
            document.getElementById('new-username').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';
        }

        function logout() {
            saveUser();
            game.user = null;
            showScreen('login');
        }

        function leaveGame() {
            saveUser();
            showScreen('menu');
            resetGame();
        }

        function saveUser() {
            if (game.user) {
                const userIndex = game.users.findIndex(u => u.username === game.user.username);
                if (userIndex !== -1) {
                    game.users[userIndex].balance = game.balance;
                    localStorage.setItem('blackjackUsers', JSON.stringify(game.users));
                }
            }
        }

        function updateUserDisplay() {
            if (game.user) {
                usernameDisplay.textContent = game.user.username;
                balanceDisplay.textContent = formatCurrency(game.balance);
                gameUsernameDisplay.textContent = game.user.username;
                gameBalanceDisplay.textContent = formatCurrency(game.balance);
            }
        }

        function formatCurrency(amount) {
            return '$' + amount.toLocaleString();
        }

        function joinTable(tableType) {
            const table = game.tableSettings[tableType];
            
            // Check if player meets minimum buy-in
            if (game.balance < table.minBuyIn) {
                showMessage(`You need at least ${formatCurrency(table.minBuyIn)} to join this table`);
                return;
            }
            
            game.table = tableType;
            game.bet = 0;
            
            // Update UI with table info
            tableTitle.textContent = `${tableType.charAt(0).toUpperCase() + tableType.slice(1)} Table`;
            tableTypeDisplay.textContent = tableType.charAt(0).toUpperCase() + tableType.slice(1);
            minBetDisplay.textContent = formatCurrency(table.minBet);
            maxBetDisplay.textContent = formatCurrency(table.maxBet);
            
            // Update chip values
            chips.forEach((chip, index) => {
                chip.textContent = table.chipValues[index];
                chip.dataset.amount = table.chipValues[index];
            });
            
            showScreen('game');
            resetGame();
        }

        function placeBet(amount) {
            if (game.gameActive) return;
            
            const newBet = game.bet + amount;
            const table = game.tableSettings[game.table];
            
            // Check if bet exceeds table maximum
            if (newBet > table.maxBet) {
                showMessage(`Maximum bet at this table is ${formatCurrency(table.maxBet)}`);
                return;
            }
            
            // Check if player has enough balance
            if (newBet > game.balance) {
                showMessage("Not enough balance");
                return;
            }
            
            game.bet = newBet;
            currentBetDisplay.textContent = formatCurrency(game.bet);
        }

        function clearBet() {
            if (game.gameActive) return;
            game.bet = 0;
            currentBetDisplay.textContent = formatCurrency(game.bet);
        }

        function deal() {
            if (game.gameActive) return;
            
            const table = game.tableSettings[game.table];
            
            // Check if bet meets minimum requirement
            if (game.bet < table.minBet) {
                showMessage(`Minimum bet at this table is ${formatCurrency(table.minBet)}`);
                return;
            }
            
            game.balance -= game.bet;
            gameBalanceDisplay.textContent = formatCurrency(game.balance);
            
            game.gameActive = true;
            game.deck = createDeck();
            game.dealerHand = [drawCard(), drawCard()];
            game.playerHand = [drawCard(), drawCard()];
            
            renderHands();
            bettingControls.style.display = 'none';
            gameControls.style.display = 'block';
            
            // Check for blackjack
            if (calculateHandValue(game.playerHand) === 21) {
                const dealerValue = calculateHandValue(game.dealerHand);
                
                if (dealerValue === 21) {
                    endGame('push');
                } else {
                    endGame('blackjack');
                }
            }
        }

        function hit() {
            if (!game.gameActive) return;
            
            game.playerHand.push(drawCard());
            renderHands();
            
            const playerValue = calculateHandValue(game.playerHand);
            
            if (playerValue > 21) {
                endGame('lose');
            } else if (playerValue === 21) {
                stand();
            }
        }

        function stand() {
            if (!game.gameActive) return;
            
            // Reveal dealer's card
            renderHands(true);
            
            // Dealer draws until 17 or higher
            while (calculateHandValue(game.dealerHand) < 17) {
                game.dealerHand.push(drawCard());
                renderHands(true);
            }
            
            const playerValue = calculateHandValue(game.playerHand);
            const dealerValue = calculateHandValue(game.dealerHand);
            
            if (dealerValue > 21) {
                endGame('win');
            } else if (dealerValue > playerValue) {
                endGame('lose');
            } else if (playerValue > dealerValue) {
                endGame('win');
            } else {
                endGame('push');
            }
        }

        function double() {
            if (!game.gameActive) return;
            
            const table = game.tableSettings[game.table];
            const newBet = game.bet * 2;
            
            // Check if doubling exceeds table maximum
            if (newBet > table.maxBet) {
                showMessage(`Cannot double - would exceed table maximum of ${formatCurrency(table.maxBet)}`);
                return;
            }
            
            // Check if player has enough balance
            if (newBet > game.balance) {
                showMessage("Not enough balance to double");
                return;
            }
            
            game.balance -= game.bet;
            game.bet *= 2;
            gameBalanceDisplay.textContent = formatCurrency(game.balance);
            currentBetDisplay.textContent = formatCurrency(game.bet);
            
            game.playerHand.push(drawCard());
            renderHands();
            
            const playerValue = calculateHandValue(game.playerHand);
            
            if (playerValue > 21) {
                endGame('lose');
            } else {
                stand();
            }
        }

        function createDeck() {
            const suits = ['♠', '♣', '♥', '♦'];
            const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
            const deck = [];
            
            for (const suit of suits) {
                for (const value of values) {
                    deck.push({ suit, value });
                }
            }
            
            // Shuffle
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            
            return deck;
        }

        function drawCard() {
            return game.deck.pop();
        }

        function calculateHandValue(hand) {
            let value = 0;
            let aces = 0;
            
            for (const card of hand) {
                if (card.value === 'A') {
                    value += 11;
                    aces++;
                } else if (['K', 'Q', 'J'].includes(card.value)) {
                    value += 10;
                } else {
                    value += parseInt(card.value);
                }
            }
            
            while (value > 21 && aces > 0) {
                value -= 10;
                aces--;
            }
            
            return value;
        }

        function renderHands(showDealerCard = false) {
            dealerHandDisplay.innerHTML = '';
            playerHandDisplay.innerHTML = '';
            
            // Dealer's hand
            game.dealerHand.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                
                if (index === 0 && !showDealerCard && game.gameActive) {
                    cardElement.classList.add('card-back');
                    dealerHandDisplay.appendChild(cardElement);
                } else {
                    if (card.suit === '♥' || card.suit === '♦') {
                        cardElement.classList.add('red');
                    } else {
                        cardElement.classList.add('black');
                    }
                    
                    const valueElement = document.createElement('div');
                    valueElement.className = 'card-value';
                    valueElement.textContent = card.value;
                    
                    const suitElement = document.createElement('div');
                    suitElement.className = 'card-suit';
                    suitElement.textContent = card.suit;
                    
                    cardElement.appendChild(valueElement);
                    cardElement.appendChild(suitElement);
                    dealerHandDisplay.appendChild(cardElement);
                }
            });
            
            // Player's hand
            game.playerHand.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                
                if (card.suit === '♥' || card.suit === '♦') {
                    cardElement.classList.add('red');
                } else {
                    cardElement.classList.add('black');
                }
                
                const valueElement = document.createElement('div');
                valueElement.className = 'card-value';
                valueElement.textContent = card.value;
                
                const suitElement = document.createElement('div');
                suitElement.className = 'card-suit';
                suitElement.textContent = card.suit;
                
                cardElement.appendChild(valueElement);
                cardElement.appendChild(suitElement);
                playerHandDisplay.appendChild(cardElement);
            });
        }

        function endGame(result) {
            game.gameActive = false;
            renderHands(true);
            
            let message = '';
            let payout = 0;
            
            switch (result) {
                case 'win':
                    payout = game.bet * 2;
                    message = 'You win!';
                    break;
                case 'lose':
                    payout = 0;
                    message = 'You lose.';
                    break;
                case 'push':
                    payout = game.bet;
                    message = 'Push.';
                    break;
                case 'blackjack':
                    payout = game.bet * 2.5;
                    message = 'Blackjack! You win 3:2!';
                    break;
            }
            
            game.balance += payout;
            game.bet = 0;
            gameBalanceDisplay.textContent = formatCurrency(game.balance);
            currentBetDisplay.textContent = formatCurrency(game.bet);
            
            showMessage(message);
            bettingControls.style.display = 'block';
            gameControls.style.display = 'none';
            
            saveUser();
        }

        function resetGame() {
            game.deck = [];
            game.dealerHand = [];
            game.playerHand = [];
            game.bet = 0;
            game.gameActive = false;
            
            dealerHandDisplay.innerHTML = '';
            playerHandDisplay.innerHTML = '';
            currentBetDisplay.textContent = formatCurrency(game.bet);
            bettingControls.style.display = 'block';
            gameControls.style.display = 'none';
            showMessage('');
        }

        function showMessage(msg) {
            messageDisplay.textContent = msg;
        }

        // Initialize
        showScreen('login');
    </script>
</body>
</html>
